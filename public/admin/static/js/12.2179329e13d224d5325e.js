webpackJsonp([12],{218:function(t,e,n){n(546);var o=n(23)(n(278),n(761),"data-v-8dbd2c74",null);t.exports=o.exports},278:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(54),i=n.n(o),a=function(t){return n.e(18).then(function(){var e=[n(247)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={name:"ApiDetails",data:function(){return{isLoading:!1,isAdd:!0,form:{id:null,mark:"test/test",verification:3,multipart_file:!1,description:"新添加的API",controller_code:"async function api (params, files, ctx, statusFun) {\n\n\t/**\n\t * API控制器\n\t * @param  {Object}   params       请求的参数\n\t * @param  {Object}   files        上传的文件(multipart/form-data)\n\t * @param  {Object}   ctx          上下文(参考koa官网)\n\t * @param  {Function} ctx.getTool  获取工具方法\n\t * @param  {Function} statusFun    统一返回的数据(code,msg,data)\n\t * @return {Object}                返回API处理后的数据\n\t */\n\n\t/**\n\t * 获取工具方法\n\t * const tool = ctx.getTool('testTool');\n\t * await tool();\n\t */\n\n\t/**\n\t * 返回处理后的数据\n\t *\n\t * return statusFun(200);\n\t * return statusFun('ok');\n\t * return statusFun(200, 'ok');\n\t * return statusFun(200, 'ok', {});\n\t *\n\t * return { code: 200, msg: 'ok', data: {} };\n\t */\n\n}",updated_at:null,created_at:null}}},props:{data:{type:Object,required:!0},config:{type:Object,required:!0}},methods:{checkCode:function(){return this.getData("core/checkCode",{code:this.form.controller_code})},onAdd:function(){var t=this;this.isLoading=!0,this.checkCode().then(function(e){return t.getData("core/api/add",t.form)}).then(function(e){t.isLoading=!1,t.$message.success("添加成功"),t.$emit("emit","ApiList",{event:"refresh"}),t.onClose()}).catch(function(e){t.isLoading=!1,t.$message.warning(e.msg)})},onUpdate:function(){var t=this;this.isLoading=!0,this.checkCode().then(function(e){return t.getData("core/api/update",t.form)}).then(function(e){t.isLoading=!1,t.$message.success("更新成功"),t.$emit("emit","ApiList",{event:"refresh"}),t.onClose()}).catch(function(e){t.isLoading=!1,t.$message.warning(e.msg)})},onClose:function(){this.isAdd?this.$emit("close","ApiAdd"):this.$emit("close","ApiDetails",this.form.id)}},components:{codemirror:a},created:function(){var t=this;null!==this.data.id&&(this.isLoading=!0,this.isAdd=!1,this.getData("core/api/get",{id:this.data.id}).then(function(e){t.isLoading=!1,i()(t.form,e)},function(e){t.$message.warning(e.msg)}))}}},477:function(t,e,n){e=t.exports=n(215)(!0),e.push([t.i,".api-details[data-v-8dbd2c74]{margin:15px}","",{version:3,sources:["D:/project/GitHub/myapp-admin/src/window/ApiDetails.vue"],names:[],mappings:"AACA,8BACC,WAAa,CACb",file:"ApiDetails.vue",sourcesContent:["\n.api-details[data-v-8dbd2c74] {\n\tmargin: 15px;\n}\n"],sourceRoot:""}])},546:function(t,e,n){var o=n(477);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n(216)("98ed0f3c",o,!0)},761:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],ref:"form",staticClass:"api-details",attrs:{model:t.form,"element-loading-text":"拼命加载中","label-width":"85px"}},[n("el-form-item",{attrs:{label:"标识"}},[n("el-input",{attrs:{placeholder:"请输入API标识"},model:{value:t.form.mark,callback:function(e){t.form.mark=e},expression:"form.mark"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"验证模式"}},[n("el-select",{attrs:{placeholder:"请选择验证模式"},model:{value:t.form.verification,callback:function(e){t.form.verification=t._n(e)},expression:"form.verification"}},[n("el-option",{attrs:{label:"所有用户",value:0}}),t._v(" "),n("el-option",{attrs:{label:"已登录的用户",value:1}}),t._v(" "),n("el-option",{attrs:{label:"超级管理员",value:2}}),t._v(" "),n("el-option",{attrs:{label:"角色权限管理",value:3}})],1)],1),t._v(" "),n("el-form-item",{attrs:{label:"文件上传"}},[n("el-switch",{model:{value:t.form.multipart_file,callback:function(e){t.form.multipart_file=e},expression:"form.multipart_file"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"描述"}},[n("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"请输入描述"},model:{value:t.form.description,callback:function(e){t.form.description=e},expression:"form.description"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"控制器代码"}},[n("div",{staticClass:"codemirror"},[n("codemirror",{ref:"myEditor",model:{value:t.form.controller_code,callback:function(e){t.form.controller_code=e},expression:"form.controller_code"}})],1)]),t._v(" "),n("el-form-item",[t.isAdd?n("el-button",{attrs:{type:"primary"},on:{click:t.onAdd}},[t._v("立即添加")]):n("el-button",{attrs:{type:"primary"},on:{click:t.onUpdate}},[t._v("修改")]),t._v(" "),n("el-button",{on:{click:t.onClose}},[t._v("取消")])],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=12.2179329e13d224d5325e.js.map